# テストを使った開発

## テストを使った開発

- テストはテストコードから書くこともあれば、対象のコードを書いて手で動作を確認した後に、その手動の内容をテストコードに落とすこともあります
- テストは無理をして書くものではありません。自分がわかりやすい方法、楽な方法で書いていきましょう
- たとえば、ブラウザがなければ確認が難しい検証項目をテストコードに落とすことは困難です。そのような場合には手動で行うなど、適材適所の使い分けが重要です

## 最終問題（初級編）
隣の人とペアを組み、ペアプログラミングをしましょう。ペアプログラミングでは、1台のPCで作業を行います

- 以下の機能がある`YAPC`モジュールを実装してください
    + 次回の YAPC::Asia は、2015年8月20日から22日に開催予定です。日付を教えてくれるモジュールを2人で作りましょう
    + `YAPC::year()`で年を4桁の整数で返します（テストをAの人が、コードをBの人が書きましょう）
    + `YAPC::month()`で月を2桁の整数で返します（テストをBの人が、コードをAの人が書きましょう）
    + `YAPC::day()`で開催日の日付の集合をハッシュリファレンスで返します（テストをAの人が、コードをBの人が書きましょう）
        - `[20, 21, 22]`のように...

## 最終問題（上級編）
- 以下の機能がある`YAPC`モジュールを実装してください
    + `YAPC::is_yet(<日付の文字列>)`で、開催前か開催後かを真か偽で返します（テストをBの人が、コードをAの人が書きましょう）
    + ｢2015年8月20日より前｣ならば開催前（真）、それ以降であれば開催後（偽）として扱うことにします
        + 日付のフォーマットは、｢4桁の年/2桁の月/2桁の日｣という形にします
        + たとえば、2015年1月1日は、｢2015/01/01｣です
- この上級編はテストもコードも結構難しいです! わからないことがあれば、サポーターに｢どうすればXXXXが出来る？｣と聞いてみましょう

## 最終問題のヒント
- `prove -l`と`prove -Ilib`は実は同じです
- `ok YAPC::is_yet();`でちゃんと真が返ってきているかをテストできます
    - 偽を調べたい時は`ok !YAPC::is_yet();`と書きます

## ワンランク上の実装へ……
- `YAPC::is_yet`は、引数として日付の文字列を受け取るのではなく、｢プログラムを実行した現在の時間｣を利用して実装することもできます
    - 日付を操作するには`Time::Piece`というモジュールを使うと良いでしょう
    - テスト内の時間を操作する場合は、`Test::MockTime`を使ってみましょう
